<!DOCTYPE html>
<html lang="en">
<head>
  <title>SoMAp â€” Generate Preform One ID</title>
  <!-- Same -->
  <script src="prefonecommon.js"></script>
  <style> body { background: linear-gradient(to right, #667eea, #764ba2); } </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-400 to-purple-600 text-white p-4">
  <div class="max-w-2xl mx-auto">
    <h1 class="text-3xl font-bold mb-6"><i class="fas fa-id-card"></i> Generate ID</h1>
    <a href="prefoneadmission.html" class="bg-gray-500 p-2 rounded mb-4 inline-block">< Back</a>
    
    <select id="studentSelect" class="p-2 rounded w-full mb-4 bg-white/20 text-white" onchange="generateID()">
      <!-- Load students -->
    </select>
    
    <div id="idCard" class="bg-white/10 p-6 rounded text-center hidden">
      <h2>Preform One ID Card</h2>
      <img id="idPhoto" class="w-32 mx-auto">
      <p id="idName"></p>
      <p id="idAdm"></p>
      <p id="idContact"></p>
      <button onclick="printID()" class="bg-green-500 p-2 rounded">Print/Save PDF</button>
    </div>
  </div>

  <script>
    db.ref(`/schools/Socrates School Preform one/${currentYear}/students`).once('value', snap => {
      const select = document.getElementById('studentSelect');
      select.innerHTML = Object.entries(snap.val() || {}).map(([adm, s]) => 
        `<option value="${adm}">${s.firstName} ${s.lastName}</option>`
      ).join('');
    });
    
    function generateID() {
      const adm = document.getElementById('studentSelect').value;
      db.ref(`/schools/Socrates School Preform one/${currentYear}/students/${adm}`).once('value', snap => {
        const s = snap.val();
        document.getElementById('idPhoto').src = s.photoUrl;
        document.getElementById('idName').textContent = `${s.firstName} ${s.middleName} ${s.lastName}`;
        document.getElementById('idAdm').textContent = `ID: ${adm}`;
        document.getElementById('idContact').textContent = `Contact: ${s.contact}`;
        document.getElementById('idCard').classList.remove('hidden');
      });
    }
    
    function printID() {
      window.print(); // Or PDF via jsPDF
      generatePDF(document.getElementById('idCard').innerHTML, 'id_card.pdf');
    }
  </script>
</body>
</html>