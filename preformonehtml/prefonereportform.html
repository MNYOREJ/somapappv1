<!DOCTYPE html>
<html lang="en">
<head>
  <title>SoMAp â€” Preform One Report Forms</title>
  <!-- Same -->
  <script src="prefonecommon.js"></script>
  <style> body { background: linear-gradient(to right, #667eea, #764ba2); } </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-400 to-purple-600 text-white p-4">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold mb-6"><i class="fas fa-file-alt"></i> Preform One Report Forms</h1>
    <a href="prefonedashboard.html" class="bg-gray-500 p-2 rounded mb-4 inline-block">< Back</a>
    
    <select id="reportType" class="p-2 rounded mb-4 bg-white/20 text-white"><option>Bulk Reports</option><option>Single Report</option></select>
    <select id="reportMonth" class="p-2 rounded mb-4 bg-white/20 text-white"><option>Sep</option><option>Oct</option><option>Nov</option><option>Dec</option></select>
    
    <button onclick="generateReports()" class="bg-blue-500 p-2 rounded">Generate</button>
    
    <div id="reportsPreview"></div>
  </div>

  <script>
    function generateReports() {
      const type = document.getElementById('reportType').value;
      const month = document.getElementById('reportMonth').value;
      if (type === 'Bulk') {
        // All students
        db.ref(`/schools/Socrates School Preform one/${currentYear}/students`).once('value', snap => {
          Object.entries(snap.val() || {}).forEach(([adm, s]) => {
            const score = s.scores?.find(sc => sc.month === month);
            const content = `Report for ${s.firstName} ${s.lastName} - ${month}\nAvg: ${score ? Object.values(score.subjects).reduce((sum, sub) => sum + sub.score, 0) / subjects.length : 0}\nAttendance: ${s.attendance.filter(a => a.present && new Date(a.date).getMonth() +1 === ['Sep','Oct','Nov','Dec'].indexOf(month) + 9 ? 'Present' : 'Absent').length / 30 * 100}%`;
            generatePDF(content, `${s.firstName}_report_${month}.pdf`);
          });
          Swal.fire('Generated!', 'Bulk reports saved.');
        });
      } else {
        // Single - select student, similar to above
        const adm = prompt('Enter Adm No');
        // ... fetch and PDF
      }
    }
  </script>
</body>
</html>